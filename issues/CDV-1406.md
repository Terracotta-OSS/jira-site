---

title: "Bad temporary file name generated by boot-jar-path.bat in non-english Windows"
layout: issue
tags: 
permalink: /browse/CDV-1406

issue_key: CDV-1406
issue_numeric_sort_key: 1406
issuetype: "Bug"
project: "Community Development (Terracotta Server)"
project_key: "CDV"
status: "Closed"
resolution: "Fixed"
priority: "2 Major"
components: "Kit & Installation"
labels: 
assignee: "hhuynh"
reporter: "jsala"
votes:  0
watchers: 0

created: "2009-10-07T06:40:28.000-0400"
updated: "2012-07-27T19:59:35.000-0400"
resolved: "2009-12-07T19:32:32.000-0500"

---



{% raw %}



## Description

<div markdown="1" class="description">

In line 76 of bin\boot-jar-path.bat a temporary file name is created as follows:

set TMPFILE=%TMP%\boot-jar-path-%RANDOM%-%TIME:~6,5%.tmp

This may produce a file name containing a comma in non-english-localized versions of Windows, because of the format returned by %TIME%. E.g. in a Spanish-localized Windows, %TIME% returns:

> echo %TIME%
12:32:56,31

So that %TIME:~6,5% will return 56,31. As a result, the script fails elsewhere when attempting to delete %TMPFILE% because it contains a comma.

One possible correction would be to use %TIME:~6,2% so the milliseconds part is not included.


</div>

## Comments


{:.comment-heading}
### **Hung Huynh** <span class="date">2009-10-21</span>

<div markdown="1" class="comment">

The milliseconds part is important when you start clients through a script and random number could be duplicated. An easy fix would be quoting the %TMPFILE%.

Could you add this on line 77:

set TMPFILE="%TMPFILE:"=%"

and try that out?


</div>


{:.comment-heading}
### **Joan Sala** <span class="date">2009-10-22</span>

<div markdown="1" class="comment">

Doesn't work. The value of TMPFILE is correctly quoted, but now the boot jar is not generated.

It seems that when executing the following line:

   for /F %%i in (%TMPFILE%) do @set DSO\1BOOT\1JAR\1NAME=%%i

the result of DSO\1BOOT\1JAR\1NAME is now set to the value of TMPFILE (i.e. the temporary file name) instead of the contents of the file, which is how it is intended to work I think (I have not studied the whole script in detail).


</div>



{% endraw %}
